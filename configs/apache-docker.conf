# Apache configuration for Docker container
# This is the main Apache configuration that includes the Mercury Relay virtual host

# Load required modules
LoadModule rewrite_module modules/mod_rewrite.so
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_wstunnel_module modules/mod_proxy_wstunnel.so
LoadModule headers_module modules/mod_headers.so
LoadModule ssl_module modules/mod_ssl.so

# Basic server configuration
ServerRoot "/usr/local/apache2"
Listen 80
Listen 443

# Include the Mercury Relay virtual host
Include conf/extra/mercury-relay.conf

# Default virtual host (fallback)
<VirtualHost *:80>
    ServerName localhost
    DocumentRoot /usr/local/apache2/htdocs
    
    <Directory "/usr/local/apache2/htdocs">
        AllowOverride None
        Require all granted
    </Directory>
    
    # Default page
    DirectoryIndex index.html
</VirtualHost>

# Logging
LogFormat "%h %l %u %t \"%r\" %>s %O \"%{Referer}i\" \"%{User-Agent}i\"" combined
LogFormat "%h %l %u %t \"%r\" %>s %O" common
LogFormat "%{Referer}i -> %U" referer
LogFormat "%{User-agent}i" agent

# Error and access logs
ErrorLog logs/error_log
CustomLog logs/access_log combined
